{% extends "template.html" %}
{% block content %}

		{% if error %}
			<p class="error"><strong>Error:</strong> {{ error }}</p>
		{% endif %}
<style>
	div.predictor {

    	padding-left: 100px;
	}
	div.col-contents {
		align-content: center;
		justify-content: left;
		text-align: left;
	}

table, th, td {
  border: 1px solid black;
}

</style>

<div class="predictor">
<form action="/CIIPPredict" method="post" enctype="multipart/form-data">
		<div class="row">
			<div class="col-sm-4">
				<div class="panel panel-primary">
					{% if testsets %}
					<div class="panel-heading">
						<h3 class="panel-title">Avaialable profiles for <b>{{ username }}</b>:<br></h3>
					</div>
					<div class="panel-body">
						{% if profiles %}
  							{% for profile in profiles %}
								{% if profiles.index(profile) == 0 %}
        							<input type="radio" name="profile_filename" value="{{ profile }}" checked="checked"> {{ profile }}
        							</input><br>
								{% else %}
        							<input type="radio" name="profile_filename" value="{{ profile }}"> {{ profile }}
        							</input><br>
								{% endif %}
							{%  endfor %}
						{% endif %}
						{% if not profiles %}
                        Please profile a dataset.
						{% endif  %}
					</div>
					{% endif %}
					{% if not testsets %}
					<div class="panel panel-heading">
						<h3 class="panel-title">No test sets available for <b>{{ username }}.</b></h3>
					</div>
					<div class="panel-body">
						You must upload a test set in order to use the CIIP predictor.
						Please visit the <a href="/datasets">Datasets</a> page to upload a test set.
					</div>
					{% endif %}
				</div>
			</div>
			<div class="col-sm-4">
				<div class="panel panel-primary">
					<div class="panel-heading">
						<h3 class="panel-title">Available test sets for <b>{{ username }}</b>.</h3>
					</div>
					<div class="panel-body">
						{% for testset in testsets %}
							{% if testsets.index(testset) == 0 %}
								<input type="radio" name="compound_filename" value="{{ testset }}" checked="checked"> {{ testset }}
								</input><br>
							{% else %}
								<input type="radio" name="compound_filename" value="{{ testset }}"> {{ testset }}
								</input><br>
							{% endif %}
						{% endfor %}
					</div>
				</div>
			</div>
		</div>

		<div class="row">
			<div class="col-sm-8">
			<div class="panel panel-primary">
				<div class="panel-heading">
					<h3 class="panel-title">Set Biological Nearest Neighbor Parameters.</h3>
				</div>
				<div class="panel-body">
				<div class="col-sm-4">
					<div class="col-contents">
						Minimum biological similarity for nearest neighbor calculation:<br>
						<br>
						<select  name="cutoff">
							<option value="0.50">0.50</option>
							<option value="0.55">0.55</option>
							<option value="0.60">0.60</option>
							<option value="0.65">0.65</option>
							<option value="0.70">0.70</option>
							<option value="0.75">0.75</option>
							<option value="0.80">0.80</option>
							<option value="0.85">0.85</option>
							<option value="0.90">0.90</option>
							<option value="0.95">0.95</option>
							<option value="1.0">1.0</option>
						</select>
					</div>
				</div>
				<div class="col-sm-4">
					<div class="col-contents">
						Please enter a confidence: <br>
						<br>
						<select  name="conf">
							<option value="0.00">0%</option>
							<option value="0.05">5%</option>
							<option value="0.10">10%</option>
							<option value="0.15">15%</option>
							<option value="0.20">20%</option>
							<option value="0.25">25%</option>
							<option value="0.30">30%</option>
							<option value="0.35">35%</option>
							<option value="0.40">40%</option>
							<option value="0.45">45%</option>
							<option value="0.50">50%</option>
							<option value="0.55">55%</option>
							<option value="0.60">60%</option>
							<option value="0.65">65%</option>
							<option value="0.70">70%</option>
							<option value="0.75">75%</option>
							<option value="0.80">80%</option>
							<option value="0.85">85%</option>
							<option value="0.90">90%</option>
							<option value="0.95">95%</option>
							<option value="1.0">100%</option>
						</select>
						</div>
					</div>
				<div class="col-sm-4">
					<div class="col-contents">
						Number of nearest neighbors to be used for BioNN activity averages:<br>
						<select name="nns">
							<option value="1">1</option>
							<option value="2">2</option>
							<option value="3">3</option>
							<option value="4">4</option>
							<option value="5">5</option>
						</select>
						</div>
				</div>
			</div>

				</div>
			</div>
		</div>
	<input type="submit" class="btn btn-primary" value="Submit" name="Submit"/>
</form>
<br>
<br>
<br>
<!-- TODO: Fix the width of the table here -->
    <div class="row" >
        <div class="col-md-3">



        </div>
    </div>

    {% if data %}

    <div class="row" >
        <div class="col-md-3">

        <table style="width:100%">
            <tr>
                <th id="test-cmp-header">{{ data|length }} Test Compounds</th>
                <th id="BioNN">Bio NNs</th>
                <th id="ChemNN">Chem NNs</th>
            </tr>
            {% for datum in data %}

                <tr>
                <td >
                    <testcmp id="{{ datum.cid }}">
                        <a href="https://pubchem.ncbi.nlm.nih.gov/compound/{{ data.cid }}" target="_blank">
                        {{ datum.cid }}
                        </a>
                    </testcmp>
                </td>

                <td>
                    <bionns id="{{ datum.cid }}-bionns">

                        {% for bionn in datum.bionn %}
                            <bionn id="{{ bionn }}">
                            <a href="https://pubchem.ncbi.nlm.nih.gov/compound/{{ bionn }}" target="_blank">
                            {{ bionn }}&nbsp
                            </a>
                            </bionn>
                        {% endfor %}
                    </bionns>
                </td>

                <td>
                    <chemnns id="{{ datum.cid }}-chemnns">

                        {% for chemnn in datum.chemnn %}
                            <chemnn id="{{ chemnn }}">
                            <a href="https://pubchem.ncbi.nlm.nih.gov/compound/{{ chemnn }}" target="_blank">
                            {{ chemnn }}&nbsp
                            </a>
                            </chemnn>
                        {% endfor %}
                    </chemnns>
                </td>
                </tr>
            {% endfor %}
        </table>
        </div>
        <div class="col-md-3">

        <table style="width:100%">
            <tr>
                <th id="test-cmp-header">{{ data|length }} Test Compounds</th>
                <th id="BioNN">Bio Predictions</th>
                <th id="ChemNN">Chem Predictions</th>
            </tr>
            {% for datum in data %}

                <tr>
                <td >
                    <testcmp id="{{ datum.cid }}-pred">
                        {{ datum.cid }}
                    </testcmp>
                </td>

                <td>
                    <biopred id="pred-bionns">
                        {{ datum.bioPred }}
                    </biopred>
                </td>

                <td>
                    <chemnns id="pred-chemnns">
                        {{ datum.chemPred }}
                    </chemnns>
                </td>
                </tr>

            {% endfor %}

        </table>

        </div>

    {% endif %}
    </div>
{% endblock %}
